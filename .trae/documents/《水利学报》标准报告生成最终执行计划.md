# 基于《水利学报》样板图片的最终执行方案

感谢您提供的图片，这使我能够精确锁定所有排版参数。我将摒弃所有模糊的转换方法，采用 **“像素级复刻”** 的策略，编写专用代码直接构建符合《水利学报》要求的 Word 文档。

## 核心参数定义 (严格对应图片)
我已建立如下参数映射表，将在代码中强制执行：
*   **页面版心**：通栏排版（Single Column），页边距上3.0cm/下2.5cm/左右2.2cm。
*   **字体字号映射**：
    *   **文章标题**：`3号黑体` (16pt) — 上下各空1行。
    *   **作者姓名**：`4号仿宋` (14pt) — 居中。
    *   **作者单位**：`6号宋体` (7.5pt) — 居中。
    *   **摘要/关键词**：`小5号宋体` (9pt) — 左右缩进。
    *   **一级标题**：`4号宋体` (14pt) — **左对齐，占3行高度**。
    *   **二级标题**：`5号黑体` (10.5pt) — 左对齐。
    *   **三级标题**：`5号楷体` (10.5pt) — 左对齐。
    *   **正文内容**：`5号宋体` (10.5pt) — 单倍行距，首行缩进。
    *   **图表说明**：`6号宋体` (7.5pt) — 居中。

## 执行步骤

### 第一步：开发学术排版引擎 (ml_backend/academic_formatter.py)
编写一个专用的 Python 模块，不依赖任何第三方转换工具，直接使用 `python-docx` 调用底层 API。
*   **功能**：定义上述所有 `Style`（样式），并精准控制段落间距（如一级标题的“占3行”）。
*   **字体处理**：强制设置中文字体为 `SimSun` (宋体), `SimHei` (黑体), `KaiTi` (楷体)，英文字体为 `Times New Roman`。

### 第二步：结构化内容生成 (ml_backend/generate_report.py)
重构生成脚本，不再输出 Markdown 文本，而是生成结构化的 **数据对象**。
*   **数据结构**：
    ```python
    report_data = {
        "title": "基于数字孪生与集成学习的智慧水利监测平台研究",
        "abstract": "...",
        "sections": [
            {"level": 1, "title": "研究背景", "content": "..."},
            {"level": 2, "title": "数据来源", "content": "..."},
            {"type": "image", "src": "real_trend.png", "caption": "图1 引张线位移趋势分析"}
        ]
    }
    ```
*   **内容清洗**：在生成数据对象时，直接过滤掉所有 `*`、`#` 等符号，确保内容纯净。
*   **亮点植入**：确保包含 **BiLSTM**、**Stacking集成模型**、**自进化智能体** 等核心技术点。

### 第三步：真实图表合成 (ml_backend/generate_assets.py)
确保插入报告的图表真实、专业。
*   **真实数据**：读取您提供的 `引张线.xlsx` 和 `静力水准.xlsx`。
*   **图表绘制**：生成高分辨率的 **时序趋势图** 和 **误差分布直方图**。
*   **架构图**：插入重绘的 **ER图** 和 **系统流程图**。

### 第四步：最终合成与验收
运行脚本生成 `智慧水利监测平台_项目报告书_水利学报版.docx`。
*   **自检标准**：
    1.  字数 > 8000。
    2.  无 Markdown 符号。
    3.  字体字号完全符合图片要求。
    4.  包含真实数据分析图表。

---
**请求批准**：
我已准备好代码逻辑，是否立即开始执行此方案？